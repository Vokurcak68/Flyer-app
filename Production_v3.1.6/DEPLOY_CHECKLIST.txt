================================================================================
  DEPLOYMENT CHECKLIST - Flyer App v3.1.6
  NEW FEATURES: Installation Type, Brand Color Icons, Screenshots
  Build Date: 2025-11-10
  BUILD VERIFIED: v3.1.6 with 3 database migrations
================================================================================

BUILD VERIFICATION COMPLETED:
==============================
[X] Backend version: 3.1.6
[X] Frontend version: 3.1.6 (footer)
[X] Frontend URLs verified: 0x localhost:4000, 13x /api
[X] Production .env verified: from backend/.env.production
[X] Database migrations: 3 migrations in MIGRATE.sql
[X] Build integrity: Clean production build

WHAT'S NEW IN v3.1.6:
=====================
1. TYP INSTALACE PRODUKT≈Æ
   - Kategorie: nov√© pole requires_installation_type (boolean)
   - Produkty: nov√© pole installation_type (BUILT_IN/FREESTANDING)
   - Conditional dropdown: zobraz√≠ se pouze pokud kategorie vy≈æaduje typ
   - Validace: nelze ulo≈æit produkt bez typu pokud kategorie to vy≈æaduje

2. BAREVN√â POZAD√ç IKON
   - Ikony: nov√© pole use_brand_color (boolean)
   - Pokud true, ikona m√° barevn√© pozad√≠ v barvƒõ znaƒçky
   - Funguje v n√°hledu i PDF

3. ≈†ED√â POZAD√ç U B√çL√ùCH IKON
   - B√≠l√©/pr≈Øhledn√© ikony automaticky dostanou ≈°ed√© pozad√≠
   - Zaji≈°≈•uje viditelnost na b√≠l√©m pozad√≠

4. 46 PLACEHOLDER≈Æ PRO SCREENSHOTY
   - UZIVATELSKY_NAVOD.html: 46 ≈°ed√Ωch placeholder≈Ø s üì∏
   - SCREENSHOTY_TODO.md: guide pro vytvo≈ôen√≠ screenshot≈Ø

5. AKTUALIZACE KONTAKT≈Æ
   - Email: eletak@oresi.cz (bez diakritiky)
   - Telefon: odstranƒõn

6. ZMEN≈†EN√Å MEZERA V PATIƒåCE
   - Z mt-12 pt-6 na mt-3 pt-1.5

PRE-DEPLOYMENT:
===============
[_] Create backup of current backend:
    Copy C:\inetpub\flyer-app\backend ‚Üí C:\inetpub\flyer-app\backup_3.1.5_YYYYMMDD

[_] Stop FlcyManagementAPI service:
    Stop-Service FlcyManagementAPI

[_] Verify backup created successfully

DATABASE MIGRATION (CRITICAL!):
================================
[_] **D≈ÆLE≈ΩIT√â: P≈ôed nasazen√≠m k√≥du spus≈• migrace!**

[_] Navigate to backend folder:
    cd C:\inetpub\flyer-app\backend

[_] Run database migrations:
    npx prisma migrate deploy

[_] Verify migrations completed:
    - Migration 1: Rename is_built_in ‚Üí requires_installation_type ‚úì
    - Migration 2: Create ENUM InstallationType + add to products ‚úì
    - Migration 3: Add use_brand_color to icons ‚úì

[_] Check for migration errors:
    If errors occur, STOP deployment and investigate!

DEPLOYMENT:
===========
[_] Copy Production_v3.1.6 contents to C:\inetpub\flyer-app\backend\

[_] **VERIFY .env file contains:**
    [_] DATABASE_URL=postgresql://flyer_app_user:...@localhost:5432/flyer_app_production
    [_] API_URL=https://eflyer.kuchyneoresi.eu
    [_] FRONTEND_URL=https://eflyer.kuchyneoresi.eu
    [_] NODE_ENV=production
    [_] PORT=4000

[_] Install dependencies if needed:
    npm ci --production

[_] Start FlcyManagementAPI service:
    Start-Service FlcyManagementAPI

[_] Wait 30 seconds for service to fully start

POST-DEPLOYMENT VERIFICATION:
==============================
[_] Backend health: https://eflyer.kuchyneoresi.eu/api/health
    Should return: {"status":"ok"}

[_] **VERSION CHECK (CRITICAL):**
    [_] Open app in browser: https://eflyer.kuchyneoresi.eu
    [_] Check footer at bottom of page
    [_] **MUST SHOW: Verze: 3.1.6**
        (pokud vid√≠≈° 3.1.5 nebo star≈°√≠, deployment se nenahr√°l spr√°vnƒõ!)

[_] Check console:
    [_] NO errors
    [_] NO "Mixed Content" warnings

FEATURE TESTING:
================
[_] **TEST 1 - TYP INSTALACE PRODUKT≈Æ:**
    [_] Login as admin
    [_] P≈ôejdi do Spr√°va kategori√≠
    [_] Edituj kategorii (nap≈ô. "Lednice")
    [_] Za≈°krtni "Vy≈æaduje typ instalace"
    [_] Ulo≈æ kategorii
    [_] P≈ôejdi do Spr√°va produkt≈Ø ‚Üí P≈ôidat produkt
    [_] Vyber kategorii "Lednice"
    [_] **OVƒö≈ò: Objevil se dropdown "Typ instalace"** ‚úì
    [_] Vyber "Vestavn√© (Built-in)"
    [_] Ulo≈æ produkt
    [_] Edituj produkt
    [_] **OVƒö≈ò: Typ instalace z≈Østal zachov√°n** ‚úì
    [_] Zkus ulo≈æit bez v√Ωbƒõru typu
    [_] **OVƒö≈ò: Validaƒçn√≠ chyba** ‚úì

[_] **TEST 2 - BAREVN√â POZAD√ç IKON:**
    [_] Login as admin
    [_] P≈ôejdi do Spr√°va ikon
    [_] Vytvo≈ô novou ikonu nebo edituj existuj√≠c√≠
    [_] Za≈°krtni "Pou≈æ√≠t barvu znaƒçky jako pozad√≠"
    [_] Ulo≈æ ikonu
    [_] Vytvo≈ô let√°k s produktem (kter√Ω m√° brand s definovanou barvou)
    [_] P≈ôidej ikonu s use_brand_color=true do produktu
    [_] **OVƒö≈ò: Ikona m√° barevn√© pozad√≠ v n√°hledu let√°ku** ‚úì
    [_] Vygeneruj PDF (St√°hnout PDF)
    [_] Otev≈ôi PDF
    [_] **OVƒö≈ò: Ikona m√° barevn√© pozad√≠ v PDF** ‚úì

[_] **TEST 3 - ≈†ED√â POZAD√ç U B√çL√ùCH IKON:**
    [_] Pou≈æij ikonu s b√≠l√Ωm/pr≈Øhledn√Ωm obsahem
    [_] Ne≈°krt√°vej "Pou≈æ√≠t barvu znaƒçky"
    [_] P≈ôidej ikonu do let√°ku
    [_] **OVƒö≈ò: Ikona m√° ≈°ed√© pozad√≠ (viditelnost na b√≠l√©m)** ‚úì
    [_] Zkontroluj v PDF
    [_] **OVƒö≈ò: ≈†ed√© pozad√≠ i v PDF** ‚úì

[_] **TEST 4 - SCREENSHOTY V N√ÅPOVƒöDƒö:**
    [_] Otev≈ôi UZIVATELSKY_NAVOD.html v prohl√≠≈æeƒçi
    [_] **OVƒö≈ò: Obsahuje 46 placeholder≈Ø s üì∏ emoji** ‚úì
    [_] **OVƒö≈ò: Ka≈æd√Ω placeholder m√° popis co m√° b√Ωt na obr√°zku** ‚úì

[_] **TEST 5 - KONTAKTY A PATIƒåKA:**
    [_] Otev≈ôi UZIVATELSKY_NAVOD.html
    [_] Scrolluj na konec (sekce "Kontakt")
    [_] **OVƒö≈ò: Email je eletak@oresi.cz (bez h√°ƒçk≈Ø/ƒç√°rek)** ‚úì
    [_] **OVƒö≈ò: Telefon nen√≠ zobrazen** ‚úì
    [_] Otev≈ôi aplikaci
    [_] **OVƒö≈ò: Mezera nad patiƒçkou je men≈°√≠ ne≈æ p≈ôedt√≠m** ‚úì

[_] **TEST 6 - REGRESE - Z√ÅKLADN√ç FUNKCE:**
    [_] Vytvo≈ô nov√Ω let√°k
    [_] P≈ôidej produkty na str√°nky
    [_] P≈ôidaj promo obr√°zek
    [_] Ulo≈æ let√°k
    [_] Odeslat k autorizaci
    [_] Reload page
    [_] **OVƒö≈ò: Promo obr√°zek st√°le v let√°ku** ‚úì
    [_] Login as pre_approver
    [_] **OVƒö≈ò: Promo v PDF** ‚úì

DATABASE VERIFICATION (TECHNICAL):
==================================
[_] Connect to production database

[_] Verify schema changes:
    SELECT column_name, data_type
    FROM information_schema.columns
    WHERE table_name = 'categories'
    AND column_name = 'requires_installation_type';

    **OVƒö≈ò: Sloupec existuje, typ boolean** ‚úì

[_] Verify ENUM creation:
    SELECT enumlabel
    FROM pg_enum e
    JOIN pg_type t ON e.enumtypid = t.oid
    WHERE t.typname = 'InstallationType';

    **OVƒö≈ò: Vr√°t√≠ BUILT_IN a FREESTANDING** ‚úì

[_] Verify product column:
    SELECT column_name, data_type
    FROM information_schema.columns
    WHERE table_name = 'products'
    AND column_name = 'installation_type';

    **OVƒö≈ò: Sloupec existuje, typ USER-DEFINED** ‚úì

[_] Verify icons column:
    SELECT column_name, data_type
    FROM information_schema.columns
    WHERE table_name = 'icons'
    AND column_name = 'use_brand_color';

    **OVƒö≈ò: Sloupec existuje, typ boolean** ‚úì

SUCCESS CRITERIA:
=================
‚úì Version 3.1.6 displayed in footer
‚úì Database migrations completed successfully
‚úì Installation type dropdown appears when category requires it
‚úì Brand color icons work in preview and PDF
‚úì White icons have gray background
‚úì 46 screenshot placeholders in user manual
‚úì Contact email updated, phone removed
‚úì Footer spacing reduced
‚úì No console errors
‚úì No regression issues

DEPLOYMENT LOG:
===============
Date: _____________
Time: _____________
Version in footer: _________ (MUST be 3.1.6!)

Database Migration Results:
- Migration 1 (rename column): SUCCESS / FAILED
- Migration 2 (enum + column): SUCCESS / FAILED
- Migration 3 (use_brand_color): SUCCESS / FAILED

Feature Test Results:
- Test 1 (Installation Type): PASS / FAIL
- Test 2 (Brand Color Icons): PASS / FAIL
- Test 3 (Gray Background): PASS / FAIL
- Test 4 (Screenshots): PASS / FAIL
- Test 5 (Contacts/Footer): PASS / FAIL
- Test 6 (Regression): PASS / FAIL

Technical Checks:
- Console errors: YES / NO (MUST be NO!)
- Backend health OK: YES / NO (MUST be YES!)
- Database schema OK: YES / NO (MUST be YES!)

Final status: SUCCESS / ROLLBACK

Deployed by: _____________

================================================================================
IMPORTANT: If version shows 3.1.5 or older, the deployment did not work!
           Stop service, verify files copied correctly, restart service.
================================================================================

TROUBLESHOOTING:
================
If version doesn't update:
1. Stop-Service FlcyManagementAPI
2. Delete contents of C:\inetpub\flyer-app\backend
3. Copy Production_v3.1.6 files again
4. Verify .env is correct
5. Start-Service FlcyManagementAPI
6. Hard refresh browser (Ctrl+F5)

If database migrations fail:
1. Check database connection in .env
2. Verify database user has ALTER permissions
3. Check if columns already exist (may need to skip migrations)
4. Contact developer before proceeding

If installation type dropdown doesn't appear:
1. Verify migration 1 and 2 completed
2. Check category has requires_installation_type=true
3. Check browser console for errors
4. Clear cache and reload

If brand color icons don't work:
1. Verify migration 3 completed
2. Check icon has use_brand_color=true
3. Check product has brand with color defined
4. Check browser console for errors

If any test fails:
1. DO NOT continue deployment
2. Note which test failed
3. Check logs for errors
4. Consider rollback if critical
5. Contact developer

ROLLBACK PROCEDURE:
===================
If deployment fails and needs rollback:

1. Stop-Service FlcyManagementAPI
2. Delete C:\inetpub\flyer-app\backend contents
3. Copy backup_3.1.5_YYYYMMDD contents back
4. Start-Service FlcyManagementAPI
5. Verify old version works
6. Database rollback may be needed - contact developer!

================================================================================
